<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ§ è‡ªå®šä¹‰éŸ³é¢‘æ’­æ”¾</title>
    <style>
    
    body {
    max-width: 100%;
    margin: 0 auto;
    padding: 10px;
    box-sizing: border-box;
    font-size: 16px;
    line-height: 1.5;  
  }
  
  @media (max-width: 600px) {
    body {
      font-size: 14px; /* å°å±å¹•ä¸‹å­—ä½“ç¼©å° */
    }
  }  

  </style>
</head>
<body>
  <h2>ä¸Šä¼ éŸ³é¢‘å¹¶è®¾ç½®æ’­æ”¾æ—¶é•¿å’Œæ§åˆ¶è¿›åº¦ ğŸ¶</h2>

  <input type="file" id="audioFile" accept="audio/*"><br><br>

  <label for="duration">è®¾ç½®æ’­æ”¾æ—¶é•¿ï¼ˆç§’ï¼‰ï¼š</label>
  <input type="number" id="duration" min="1" value="10"><br><br>

  <button onclick="playAudio()">æ’­æ”¾éŸ³é¢‘</button>
  <button onclick="stopAudio()">åœæ­¢éŸ³é¢‘</button><br><br>

  <button onclick="seekAudio(-5)">âª å€’é€€5ç§’</button>
  <button onclick="seekAudio(5)">â© å¿«è¿›5ç§’</button><br><br>

  <label for="loop">å¾ªç¯æ’­æ”¾ï¼š</label>
  <input type="checkbox" id="loop"><br><br>

  <audio id="audioControl" controls></audio>
  <div id="downloadContainer"></div> <!-- ä¸‹è½½é“¾æ¥å®¹å™¨ -->

  <script>
    let audio = document.getElementById("audioControl");
    let loopInterval = null;

    // æ’­æ”¾éŸ³é¢‘
    function playAudio() {
      const fileInput = document.getElementById("audioFile");
      if (fileInput.files.length === 0) {
        alert("è¯·ä¸Šä¼ ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼");
        return;
      }

      const file = fileInput.files[0];
      const audioUrl = URL.createObjectURL(file);
      audio.src = audioUrl;
      audio.play();

      const duration = parseInt(document.getElementById("duration").value);
      const loop = document.getElementById("loop").checked;

      if (loop) {
        audio.loop = false; // ç¦ç”¨é»˜è®¤çš„å¾ªç¯æ’­æ”¾
        audio.addEventListener('ended', function() {
          audio.currentTime = 0; // é‡ç½®æ’­æ”¾è¿›åº¦
          audio.play(); // é‡æ–°æ’­æ”¾
        });
      }

      // è®¾ç½®æ’­æ”¾æ—¶é•¿
      setTimeout(() => {
        if (!loop) stopAudio();
      }, duration * 1000);
    }

    // åœæ­¢éŸ³é¢‘
    function stopAudio() {
      if (audio) {
        audio.pause();
        audio.currentTime = 0;
        audio = null;
      }
      if (loopInterval) {
        clearInterval(loopInterval);
        loopInterval = null;
      }
    }

    // å¿«è¿›å’Œå€’é€€åŠŸèƒ½
    function seekAudio(seconds) {
      if (audio && audio.readyState >= 1) {
        let newTime = audio.currentTime + seconds;
        newTime = Math.max(0, Math.min(newTime, audio.duration));
        audio.currentTime = newTime;
      } else {
        console.warn("éŸ³é¢‘è¿˜æ²¡å‡†å¤‡å¥½å‘¢å®è´ï¼Œç­‰ç­‰å®ƒå˜›ï½ğŸ¥º");
      }
    }
  </script>
</body>
</html>
